---
title: "Git笔记"
date: 2022-04-07
tag:
    - git
categories:
    - git
---

## 1.git 版本

### I.版本回退

```shell
# 1.使用 git log 命令历史版本记录回退版本
git reset --hard f6a7c803a6931a9ec
git reset --soft f6a7c803a6931a9ec
# 撤回上一次提交
git reset --soft HEAD^

# 2.推送到远程
git push -f -u origin xxxx（需要回退的分支）
# 或者推送到远程分支并创建
 git push origin -u feature/xxxx

# 3.git撤回add
git reset HEAD

# 4.撤销上一次提交
git reset --soft HEAD^

# 5.比较两个分支差异
git diff branch1 branch2 --stat        #显示出所有有差异的文件列表
git diff branch1 branch2 具体文件路径    #显示指定文件的详细差异
git diff branch1 branch2               #显示出所有有差异的文件的详细差异

# 6.revert 常规commit：
git revert <commit id> # 即可，git 会生成一个新的 commit，将指定的 commit 内容从当前分支上撤除。
```

### II.版本 tag

```shell
# 给分支加tag
git tag #（查看当前标签）

git tag -a 版本号(v1.0.0) -m “(注释)”
# -a 0.1.3是增加 名为0.1.3的标签
# -m 后面跟着的是标签的注释, 如：
git tag -a 0.1.3 -m 'Release version 0.1.3'

# 把分支推送到远程上
git push origin tagName
# 例：
git tag -a v4.9.3 -m “v4.9.3”
git push origin v4.9.3

# 把本地所有的tags推到服务器，普通的git push origin master操作不会推送标签到服务器端。
git push origin --tags

git tag --list  # 查看已有tag列表
git checkout [tag/branch/commit]  # 切换到指定tag/branch/commit都是此命令

# 删除tag
#1. 删除本地tag
git tag -d v4.9.3
#2. 删除远程tag
git push origin --delete v4.9.3     #(新版本>1.7)
git push origin :refs/tags/v4.9.3   #(<1.7老版本)
```

---

## 2.分支管理

### I.远程仓库

```shell
# 1.查看远程关联
git remote -v

# 2.添加关联远程地址
git remote add origin https://xxxx.git

# 3.修改关联地址
# 方式1、直接修改：
git remote set-url origin xxxxx.git
# 方式2、先删后加 ：
git remote rm origin
git remote add origin xxxxx.git

# 4.删除指定远程地址
git remote remove origin

# 5.新创建git仓库
git remote add origin https://xxxx.git
git push -u origin master
```

### II.分支管理

```shell
# 查看分支
git branch
git branch -a  #查看本地及远程

# 删除分支
git branch -D xxxx

# git 删除本地存在，远程已经删除的分支
git remote prune origin

# 切换分支
git checkout xxxx
git checkout -b xxxx #创建分支并切换
git checkout -b xxxx origin/xxxx #创建切换并关联远程

# 修改分支名
#如果对于分支不是当前分支，可以使用下面代码：
git branch -m "原分支名" "新分支名"
#如果是当前，那么可以使用加上新名字
git branch -m "新分支名称"

# 修改默认pull和push分支：
git branch --set-upstream-to=origin/develop develop
# origin/develop develop为要设置的默认分支

# 本地推远程，创建远程新分支并关联
git push --set-upstream origin xxxx

```

### III.分支合并

```shell
# 可以允许不相关历史提，强制合并
git pull origin master --allow-unrelated-histories

# Git merge
# 1、合并xxx分支，并保留其所有commit
git merge —no-ff  xxx
# 2、合并xxx分支，压缩器commit 记录成一个
git merge —squash xxx

# git-rebase
# 1.将多次commit合并，只保留一次提交历史记录
git rebase -i HEAD~6
git rebase -i xxxx ##(合并前三个，xxxx为第4个hash)

git add .
git rebase --continue
# 2.若无冲突 or 冲突已 fix，则会出现一个 commit message 编辑页面，修改 commit message ，然后 输入：wq or x 保存退出。

# 若想退出放弃此次压缩，执行命令：
git rebase --abort

# 将多个commit 合并到另一个分支
git rebase [startpoint] [endpoint] --onto [branchName]


# cherry-pick
## git cherry-pick命令的作用，就是将指定的提交（commit）应用于其他分支。
# 当前分支，如：把dev的 xxxx 一次提交 贴到 feature分支
git log      #复制当前分支的xxxx hash
git checkout -b feature #切换分支
git cherry-pick xxxx
```

git-rebase from => <https://www.jianshu.com/p/571153f5daa1>

---

## 3.git 配置

### I.git 全局配置命令

```shell
git config --global user.name xxxx #添加配置用户

 git config --global --replace-all user.name xxxx #修改配置用户

git config --global user.email xxx.@xx.com #添加配置用户邮件

git config --global --replace-all user.email xxx.@xx.com  #修改配置用户邮件

git config --global -l #查看添加全局变量修改的配置信息 

git config -l  #查看所有配置
```

### II.ssh 密钥

```shell
# mac git生成ssh密钥
# 1.本地生成公钥
ssh-keygen -o
# 2.查看
cat ~/.ssh/id_rsa.pub
```
